# PC Test System – PRD

**版本**：v1.1  
**基于**：PC Test System SPEC v1.3.6  

---

## 1. 背景与目标（Why）

### 1.1 背景问题
当前 PC 测试存在以下痛点：
- 测试用例分散、执行方式不统一  
- 参数与环境不一致，结果不可复现  
- 测试脚本与执行工具强耦合，演进困难  
- 缺乏从单用例到整机验证的统一模型  
- 结果难以追溯、统计与复盘  

### 1.2 产品目标
构建一个运行在被测机本地的 PC 测试系统，用于：
- 标准化测试交付、执行与结果  
- 系统化组织 Test Case / Test Suite / Test Plan  
- 提供可复现、可追溯、可审计的测试执行记录  
- 在安全边界内最大化脚本自由度  

---

## 2. 产品定位（What）

### 2.1 一句话定义
一个运行在 Windows PC 本地的自动化测试执行与管理工具，以 Manifest + Script 为核心交付物，支持从单用例到整机验证的统一执行与结果管理。

### 2.2 目标用户
- 测试工程师  
- 系统验证工程师（SV）  
- 实验室 / 产线人员  
- 项目与质量负责人  

---

## 3. 核心使用场景

### 场景 1：执行单个测试用例
- 选择 Test Case  
- 填写参数并执行  
- 查看日志与结果  

### 场景 2：执行测试套件（Test Suite）
- 执行一组相关测试  
- 共享参数与环境  
- 获得 Suite 级汇总结果  

### 场景 3：执行完整测试计划（Test Plan）
- 一次执行完整系统验证  
- 统一参数与环境  
- 生成 Plan 级结果  

### 场景 4：回溯历史测试
- 浏览历史 Run  
- 精确追溯用例、版本、参数、环境与结果  

---

## 4. 核心概念模型

### 4.1 三层结构
```
Test Plan
 └── Test Suite
      └── Test Case
```

### 4.2 交付物模型
- 测试用例：Manifest + PowerShell Script  
- 执行结果：Run Folder + JSON Result  

---

## 5. 功能需求

### FR-1 测试发现
- 从指定 Root 发现 Test Case / Suite / Plan  
- 不依赖固定目录结构  

### FR-2 参数配置
- Test Case 定义参数  
- Suite / Plan 定义共享参数  
- UI 自动生成输入并校验  

### FR-3 执行控制
- 支持超时、失败策略、用户中止  

### FR-4 环境注入
- 支持环境变量与工作目录  
- 所有变更可追溯  

### FR-5 执行与隔离
- 每次执行生成独立 Run Folder  
- Script 写入受限区域  

### FR-6 结果与日志
- 自动捕获 stdout / stderr  
- 生成结构化结果  
- Suite / Plan 自动汇总  

### FR-7 历史记录
- 所有 Run 可回溯  
- 保留 Case / Suite / Plan 关系  

### FR-8 Test Case 执行与管理（核心能力）

系统必须对每一个 Test Case 执行提供**强控制、强隔离、强可追溯性**：

#### 执行控制
- 每个 Test Case 在独立执行上下文中运行  
- 系统可对单个 Test Case 执行启动、超时控制、强制终止与用户中止  

#### 执行裁决
- Test Case 的最终执行状态由系统判定，而非脚本自报  
- Script 异常、崩溃或无响应时，系统仍能生成有效执行结果  

#### 结果与审计
- 每一次 Test Case 执行都会生成独立、不可变的执行记录  
- 执行记录至少包含：
  - Test Case 标识与版本  
  - 实际生效的参数  
  - 执行时间与最终状态  

#### 执行隔离
- Test Case 运行期间仅能访问受控的工作目录  
- 测试脚本被视为不可信输入  

---

## 6. 非功能需求

- 稳定性：Runner 是 Test Case 执行最终裁决者  
- 可演进性：Schema Version 管理  
- 可观测性：结果与日志可独立分析  
- 安全性：路径、权限严格限制  

---

## 7. 明确不包含内容（Out of Scope）

- 分布式执行  
- 远程调度  
- Web UI  
- 并行执行（v1）  

---

## 8. Stakeholder 需确认的关键点

1. 是否认可三层模型（Plan / Suite / Case）  
2. 是否接受系统对 Test Case 执行结果拥有最终裁决权  
3. 是否接受结构化 JSON 结果作为唯一执行事实  
4. 是否接受 v1 仅支持顺序执行  
5. 是否接受 Manifest 作为强约束合同  

---

## 9. 成功标准

- 稳定执行完整 Test Plan  
- 任意一次 Run 在无 UI 情况下可复现  
- 新增 Test Case 不需要修改 Engine / Runner  
- 系统在脚本异常情况下仍能给出确定性结果  
- Stakeholder 能理解并认可结果结构  

---

## 10. 附录

- PRD 来源：PC Test System SPEC v1.3.6  
- PRD 用于需求共识，SPEC 用于工程实现  
