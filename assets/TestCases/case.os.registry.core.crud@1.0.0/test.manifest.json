{
  "schemaVersion": "1.5.0",
  "id": "case.os.registry.core.crud",
  "name": "Windows Registry Verification",
  "description": "Unified Windows registry test case supporting registry file execution and value verification",
  "version": "1.0.0",
  "category": "Software",
  "owner": "PVT-X",
  "privilege": "AdminPreferred",
  "timeoutSec": 30,
  "parameters": [
    {
      "name": "Mode",
      "type": "enum",
      "required": true,
      "enumValues": ["set_reg", "verify_reg"],
      "help": "Operation mode: set_reg applies registry changes (add/update/delete) via .reg file, verify_reg checks registry values"
    },
    {
      "name": "VerifySpec",
      "type": "json",
      "required": false,
      "default": "[{\"path\":\"HKCU\\\\Control Panel\\\\International\",\"name\":\"CurrentuserLang\",\"expected\":{\"type\":\"String\", \"data\": \"en-US\"}}]",
      "uiHint": "textarea",
      "help": "Array of registry value verification specs (required when Mode=verify_reg): [{\"path\":\"HKCU\\\\Software\\\\International\",\"name\":\"CurrentuserLang\",\"expected\":{\"type\":\"String\",\"data\":\"en-US\"}}]. Actual registry values are always included in report.json results"
    },
    {
      "name": "RegFilePath",
      "type": "path",
      "required": false,
      "help": "Path to .reg file to execute (required when Mode=set_reg)"
    },
    {

      "name": "ArtifactExportScope",
      "type": "json",
      "required": false,
      "default": "{\"enabled\": false}",
      "uiHint": "textarea",
      "help": "Registry export configuration: {\"enabled\": true, \"keys\": [\"HKLM\\\\Software\\\\Example\"], \"format\": \"reg\"}. Supported in both set_reg and verify_reg modes"
    }
  ],
  "tags": ["registry", "windows", "configuration", "crud", "verification"]
}
