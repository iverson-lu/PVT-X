{
  "schemaVersion": "1.5.0",
  "id": "case.os.registry.core.crud",
  "name": "Windows Registry CRUD",
  "description": "Unified Windows registry test case supporting registry file execution and value verification",
  "version": "1.0.0",
  "category": "Software",
  "owner": "PVT-X",
  "privilege": "User",
  "timeoutSec": 30,
  "parameters": [
    {
      "name": "Mode",
      "type": "enum",
      "required": true,
      "enumValues": ["execute_reg", "verify_value"],
      "help": "Operation mode: execute_reg applies .reg file changes, verify_value checks registry values"
    },
    {
      "name": "RegFilePath",
      "type": "path",
      "required": false,
      "help": "Path to .reg file to execute (required when Mode=execute_reg)"
    },
    {
      "name": "RequireAdmin",
      "type": "boolean",
      "required": false,
      "default": false,
      "help": "If true, verify administrator privileges before execution (Mode=execute_reg only)"
    },
    {
      "name": "ArtifactCopyReg",
      "type": "boolean",
      "required": false,
      "default": true,
      "help": "If true, copy the input .reg file to artifacts (Mode=execute_reg only)"
    },
    {
      "name": "ArtifactExportScope",
      "type": "json",
      "required": false,
      "default": "{\"enabled\": false}",
      "uiHint": "textarea",
      "help": "Registry export configuration: {\"enabled\": true, \"keys\": [\"HKLM\\\\Software\\\\Example\"], \"format\": \"reg\"}. Supported in both execute_reg and verify_value modes"
    },
    {
      "name": "VerifySpec",
      "type": "json",
      "required": false,
      "default": "[{\"path\":\"HKCU\\\\Control Panel\\\\International\",\"name\":\"CurrentuserLang\",\"expected\":{\"type\":\"String\", \"data\": \"en-US\"}}]",
      "uiHint": "textarea",
      "help": "Array of registry value verification specs (required when Mode=verify_value): [{\"path\":\"HKCU\\\\Software\\\\International\",\"name\":\"CurrentuserLang\",\"expected\":{\"type\":\"String\",\"data\":\"en-US\"}}]. Actual registry values are always included in report.json results"
    }
  ],
  "tags": ["registry", "windows", "configuration", "crud", "verification"]
}
